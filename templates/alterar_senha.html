{% extends 'base.html' %}

{% block content %}
<div class="max-w-md mx-auto bg-white bg-opacity-90 backdrop-blur-md p-8 rounded-2xl shadow-2xl mt-12 animate-fade-in">
    <!-- Título -->
    <h2 class="text-3xl font-extrabold text-center text-gray-900 mb-8 bg-gradient-to-r from-indigo-600 to-blue-500 text-transparent bg-clip-text">
        Alterar Senha
    </h2>

    <!-- Mensagens de Erro ou Sucesso -->
    {% with messages = get_flashed_messages(with_categories=True) %}
        {% if messages %}
            {% for category, message in messages %}
                {% if category != 'success' %}
                    <div class="mb-6 p-4 bg-red-50 border-l-4 border-red-500 rounded-lg text-red-700 animate-fade-up">
                        <p>{{ message }}</p>
                    </div>
                {% endif %}
            {% endfor %}
        {% endif %}
    {% endwith %}

    <!-- Formulário -->
    <form method="POST" class="space-y-6">
        <!-- Senha Atual -->
        <div>
            <label for="senha_atual" class="block text-sm font-semibold text-gray-700 mb-1">Senha Atual</label>
            <input type="password" name="senha_atual" id="senha_atual" required
                   class="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-400 focus:outline-none transition-all duration-200">
        </div>

        <!-- Nova Senha -->
        <div>
            <label for="nova_senha" class="block text-sm font-semibold text-gray-700 mb-1">Nova Senha</label>
            <input type="password" name="nova_senha" id="nova_senha" required
                   class="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-400 focus:outline-none transition-all duration-200">
        </div>

        <!-- Confirmar Nova Senha -->
        <div>
            <label for="confirmar_senha" class="block text-sm font-semibold text-gray-700 mb-1">Confirmar Nova Senha</label>
            <input type="password" name="confirmar_senha" id="confirmar_senha" required
                   class="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-400 focus:outline-none transition-all duration-200">
        </div>

        <!-- Botão Alterar Senha -->
        <button type="submit"
                class="w-full bg-gradient-to-r from-indigo-600 to-blue-600 text-white py-3 rounded-lg shadow-md hover:from-indigo-700 hover:to-blue-700 transition-all duration-300 transform hover:scale-105">
            Alterar Senha
        </button>
    </form>
</div>

<!-- Modal de Sucesso -->
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            {% if category == 'success' %}
                <div id="success-modal" class="fixed inset-0 flex items-center justify-center z-50 bg-gray-900 bg-opacity-50 animate-fade-in">
                    <div class="bg-white p-6 rounded-xl shadow-xl max-w-sm w-full animate-pop-in">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-xl font-semibold text-green-700 flex items-center">
                                <span class="mr-2">✅</span> Sucesso!
                            </h2>
                            <button onclick="document.getElementById('success-modal').style.display='none'" class="text-gray-500 hover:text-gray-700 text-2xl">
                                ×
                            </button>
                        </div>
                        <p class="text-gray-700">{{ message }}</p>
                        <div class="mt-6 flex justify-end">
                            <a href="{{ url_for('index') }}"
                               class="bg-gradient-to-r from-green-600 to-green-700 text-white py-2 px-4 rounded-lg hover:from-green-700 hover:to-green-800 transition-all duration-200">
                                Ok
                            </a>
                        </div>
                    </div>
                </div>
                <script>
                    setTimeout(function() {
                        document.getElementById('success-modal').style.display = 'flex';
                    }, 200);
                </script>
            {% endif %}
        {% endfor %}
    {% endif %}
{% endwith %}

<!-- Animações -->
<style>
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in {
        animation: fadeIn 0.6s ease-out;
    }

    @keyframes fadeUp {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-up {
        animation: fadeUp 0.4s ease-out;
    }

    @keyframes popIn {
        0% { opacity: 0; transform: scale(0.9); }
        60% { opacity: 1; transform: scale(1.05); }
        100% { transform: scale(1); }
    }
    .animate-pop-in {
        animation: popIn 0.5s ease-out;
    }
</style>
{% endblock %}